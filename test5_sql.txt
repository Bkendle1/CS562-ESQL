with pa_tb as 
(
	select cust, prod, sum(quant) as pa_sum
	from sales
	where state = 'PA' and year = 2016
	group by cust, prod
),
ct_tb as 
(
	select cust, prod, sum(quant) as ct_sum
	from sales
	where state = 'CT' and year = 2020
	group by cust, prod
)
select cust, prod, sum(quant), pa_sum, ct_sum
from sales natural join pa_tb natural join ct_tb
where ct_sum > pa_sum
group by cust, prod, pa_sum, ct_sum